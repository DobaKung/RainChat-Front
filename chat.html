<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rain Chat</title>
    <link rel="stylesheet" href="css/material.min.css">
    <link rel="stylesheet" href="css/dist/chat.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://webfonts.fontstand.com/WF-004772-a609fb9a2bcd7b43b73445197bcb1b20.css"
    type="text/css">
    <script src="https://unpkg.com/vue"></script>
</head>
<body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">
        <header class="mdl-layout__header">
            <div class="mdl-layout__header-row">
                <div class="roomname">Anonymous Group</div>
            </div>
        </header>
        <div class="mdl-layout__drawer">
            <span class="mdl-layout-title">
                <img src="img/logo-sidebar.png" alt="Rainy Chat">
            </span>
            <nav class="mdl-navigation">
                <span class="chatrooms">Rooms you're logged in</span>
                <hr>
                <a class="mdl-navigation__link" href="">
                    <strong>Anonymous Room</strong><br>
                    last message appears...
                </a>
                <a class="mdl-navigation__link" href="">
                    <strong>Anonymous Room</strong><br>
                    last message appears...
                </a>
                <a class="mdl-navigation__link" href="">
                    <strong>Anonymous Room</strong><br>
                    last message appears...
                </a>
            </nav>
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect bottom-drawer add">
                Add
            </button>
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect bottom-drawer logout">
                Logout
            </button>
        </div>
        <main class="mdl-layout__content">
            <div class="page-content">
                <div class="mdl-grid">
                    <div class="mdl-cell mdl-cell--12-col" style="margin-bottom:6em;" id="chatlog">
                        <div class="bubble others">
                            Test for the opposite
                        </div>
                        <div class="bubble me">
                            Test for this side
                        </div>
                    </div>
                </div>
                <div class="textinput">
                    <form id="chatlog">
                        <div class="mdl-textfield mdl-js-textfield">
                            <input class="mdl-textfield__input" type="text" id="chat" name="command" autofocus="1">
                            <label class="mdl-textfield__label" for="chat">Type here</label>
                            <button id="submit" style="display: none;">Send</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>
    <script defer src="js/material.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script type="text/javascript">
    function connect(host, port) {
        // connect to server socket
        ws = new WebSocket('ws://' + host + ':' + '8080');
        console.log(ws);
        return ws
    }
    function sendMessage() {
        // @DOBA: do something when form is submitted
        message = $('#chat').val();
        $('#chat').val('');
        ws.send(message);
        showMessage('myself: ' + message);
    }
    function showMessage(message){
        // @DOBA: do something if recieve a [message]
        $('#chatlog').append('<div class="bubble">' + message + '</div>');
        console.log('Message received:' + message);
    }
    ws = connect('52.74.90.15', '8080'); // ec2-host
    ws.onopen = function() {
        // @DOBA: do something when connection is established
        $('#chatlog').on('submit', function(e) {
            e.preventDefault();
            sendMessage();
        });
    }
    ws.onmessage = function(event) {
        showMessage('anonymous: ' + event.data);
    }
</script>
</body>
</html>
